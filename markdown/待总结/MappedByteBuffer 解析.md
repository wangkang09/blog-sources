一种直接字节缓冲区，其内容是文件的内存映射区。



映射字节缓冲区是通过FileChannel.map方法创建的。此类继承于 ByteBuffer 并提供了特定的针对 memory-mapped 的操作。



映射的字节缓冲区及其表示的文件映射在**缓冲区本身**被垃圾回收之前保持有效。

- 可知 MappedByteBuffer 是可被垃圾回收的
- 只有被垃圾回收后，字节缓存区和文件映射才会失效！



映射字节缓冲区的内容可以随时更改，例如，如果此程序或其他程序更改了映射文件的相应区域的内容。但是，**更改的时机不确定！**



映射字节缓冲区的全部或部分在任何时候都可能变得不可访问，例如，如果映射文件被截断。尝试访问映射字节缓冲区的不可访问区域不会更改缓冲区的内容，并将导致在访问时或稍后引发未指定的异常。因此，强烈建议采取适当的预防措施，以避免此程序或同时运行的程序对映射文件进行操作，但读取或写入文件内容的操作除外。



除此之外，映射字节缓冲区的行为与普通直接字节缓冲区没有区别。



| 返回值类型                                                   | 方法名         | 描述                                                         |
| ------------------------------------------------------------ | -------------- | ------------------------------------------------------------ |
| [MappedByteBuffer](https://docs.oracle.com/javase/7/docs/api/java/nio/MappedByteBuffer.html) | **force**()    | 强制将对此缓冲区内容所做的任何更改写入包含映射文件的存储设备 |
| boolean                                                      | **isLoaded**() | 指示此缓冲区的内容是否驻留在物理内存中                       |
| [MappedByteBuffer](https://docs.oracle.com/javase/7/docs/api/java/nio/MappedByteBuffer.html) | **load**()     | 将缓冲区的内容加载到物理内存中                               |



**force**()  ：

- 如果映射到此缓冲区的文件位于本地存储设备上，则当此方法返回时，将确保自创建缓冲区或上次调用此方法以来对其所做的所有更改都已写入该设备。

- 如果文件不在本地设备上，则不作此类保证。
- 如果此缓冲区未在读/写模式（FileChannel.MapMode.read_write）下映射，则调用此方法无效。

**load**()：

- 此方法尽最大努力确保返回时，缓冲区的内容驻留在物理内存中。调用此方法可能会导致一些页面错误和I/O操作发生。

**isLoaded**()  ：

- 如果返回值为true，则表示此缓冲区中的所有数据很可能都驻留在物理内存中，因此可以在不引起任何虚拟内存页错误或I/O操作的情况下访问。返回值false并不一定意味着缓冲区的内容不驻留在物理内存中
- 返回值只能当作参考



<https://www.jianshu.com/p/f90866dcbffc>